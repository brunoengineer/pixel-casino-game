var g=Object.defineProperty;var b=(o,e,t)=>e in o?g(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var r=(o,e,t)=>b(o,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();const m=["coin","sword","shield","axe","book"],p={coin:40,sword:30,shield:20,axe:8,book:2},y={coin:1,sword:2,shield:4,axe:10,book:50};function h(){const o=Object.values(p).reduce((t,s)=>t+s,0);let e=Math.random()*o;for(const t of m)if(e-=p[t],e<=0)return t;return m[0]}const f=5,S=5,B=500,d=5;class E{constructor(e){r(this,"element");r(this,"strip");r(this,"symbols",[]);r(this,"stoppedSymbols",[]);this.element=document.createElement("div"),this.element.className="reel",this.strip=document.createElement("div"),this.strip.className="reel-strip",this.initializeSymbols(),this.element.appendChild(this.strip),e.appendChild(this.element)}initializeSymbols(){for(let e=0;e<20;e++){const t=h();this.symbols.push(t);const s=document.createElement("div");s.className="symbol";const i=document.createElement("img");i.src=`./img/${t}.png`,i.alt=t,i.className="symbol-img",s.appendChild(i),this.strip.appendChild(s)}}spin(){this.element.classList.add("spinning")}stop(e){return new Promise(t=>{this.element.classList.remove("spinning"),this.stoppedSymbols=[h(),h(),h()];const s=this.strip.querySelectorAll(".symbol"),i=s[0]?s[0].offsetHeight:120,n=-(e*i-i);this.strip.style.top=`${n}px`;const a=e-1;if(a>=0&&s[a]){let l=s[a].querySelector("img");l||(l=document.createElement("img"),l.className="symbol-img",s[a].appendChild(l)),l.src=`./img/${this.stoppedSymbols[0]}.png`,l.alt=this.stoppedSymbols[0]}if(s[e]){let l=s[e].querySelector("img");l||(l=document.createElement("img"),l.className="symbol-img",s[e].appendChild(l)),l.src=`./img/${this.stoppedSymbols[1]}.png`,l.alt=this.stoppedSymbols[1]}const c=e+1;if(c<s.length&&s[c]){let l=s[c].querySelector("img");l||(l=document.createElement("img"),l.className="symbol-img",s[c].appendChild(l)),l.src=`./img/${this.stoppedSymbols[2]}.png`,l.alt=this.stoppedSymbols[2]}setTimeout(t,300)})}getVisibleSymbols(){return this.stoppedSymbols.length>0?this.stoppedSymbols:[this.symbols[0],this.symbols[1],this.symbols[2]]}setSymbol(e,t){const s=this.strip.querySelectorAll(".symbol");if(s[e]){const i=s[e].querySelector("img");i&&(i.src=`./img/${t}.png`,i.alt=t),this.symbols[e]=t}}highlightWin(){this.element.classList.add("winning")}clearHighlight(){this.element.classList.remove("winning")}}class w{constructor(){r(this,"reels",[]);r(this,"state",{balance:1e3,bet:10,isSpinning:!1,reelPositions:[0,0,0,0,0]});r(this,"elements",{reelsContainer:document.getElementById("reelsContainer"),spinBtn:document.getElementById("spinBtn"),skipBtn:document.getElementById("skipBtn"),autoSpinBtn:document.getElementById("autoSpinBtn"),balanceDisplay:document.getElementById("balance"),betDisplay:document.getElementById("bet"),messageDisplay:document.getElementById("message"),increaseBetBtn:document.getElementById("increaseBet"),decreaseBetBtn:document.getElementById("decreaseBet")});r(this,"skipRequested",!1);r(this,"autoSpinEnabled",!1);this.initializeReels(),this.attachEventListeners(),this.updateDisplay()}initializeReels(){for(let e=0;e<f;e++){const t=new E(this.elements.reelsContainer);this.reels.push(t)}}attachEventListeners(){this.elements.spinBtn.addEventListener("click",()=>this.spin()),this.elements.skipBtn.addEventListener("click",()=>this.skipSpin()),this.elements.autoSpinBtn.addEventListener("click",()=>this.toggleAutoSpin()),this.elements.increaseBetBtn.addEventListener("click",()=>this.increaseBet()),this.elements.decreaseBetBtn.addEventListener("click",()=>this.decreaseBet())}skipSpin(){this.skipRequested=!0}increaseBet(){let e;this.state.bet<100?e=this.state.bet+d:e=this.state.bet+100,e<=B&&e<=this.state.balance&&(this.state.bet=e,this.updateDisplay())}decreaseBet(){let e;this.state.bet<=100?e=this.state.bet-d:e=this.state.bet-100,e>=S&&(this.state.bet=e,this.updateDisplay())}toggleAutoSpin(){this.autoSpinEnabled=!this.autoSpinEnabled,this.autoSpinEnabled?(this.elements.autoSpinBtn.textContent="AUTO SPIN: ON",this.elements.autoSpinBtn.classList.add("active"),this.startAutoSpin()):(this.elements.autoSpinBtn.textContent="AUTO SPIN: OFF",this.elements.autoSpinBtn.classList.remove("active"))}async startAutoSpin(){for(;this.autoSpinEnabled&&this.state.balance>=this.state.bet;)await this.spin(),this.autoSpinEnabled&&await new Promise(e=>setTimeout(e,1e3));this.state.balance<this.state.bet&&(this.autoSpinEnabled=!1,this.elements.autoSpinBtn.textContent="AUTO SPIN: OFF",this.elements.autoSpinBtn.classList.remove("active"),this.showMessage("Insufficient balance for auto spin!"))}async spin(){if(this.state.isSpinning||this.state.balance<this.state.bet){this.showMessage("Insufficient balance!");return}this.reels.forEach(t=>t.clearHighlight()),this.elements.messageDisplay.classList.remove("win"),this.state.isSpinning=!0,this.skipRequested=!1,this.state.balance-=this.state.bet,this.updateDisplay(),this.showMessage(""),this.elements.spinBtn.style.display="none",this.elements.skipBtn.style.display="inline-block",this.reels.forEach(t=>t.spin());const e=[];for(let t=0;t<this.reels.length;t++)e.push(Math.floor(Math.random()*10)+5);for(let t=0;t<this.reels.length;t++){if(this.skipRequested){for(let s=t;s<this.reels.length;s++)await this.reels[s].stop(e[s]);break}await new Promise(s=>setTimeout(s,500)),await this.reels[t].stop(e[t])}this.elements.skipBtn.style.display="none",this.elements.spinBtn.style.display="inline-block",this.state.reelPositions=e,await this.checkWins(),this.state.isSpinning=!1,this.updateDisplay()}async checkWins(){const e=this.reels.map(n=>n.getVisibleSymbols()[1]),t=new Map;e.forEach(n=>{t.set(n,(t.get(n)||0)+1)});let s=null,i=0;if(t.forEach((n,a)=>{n>i&&(i=n,s=a)}),this.reels.forEach(n=>n.clearHighlight()),i>=3&&s){const n=y[s],a=i===3?1:i===4?3:8,c=this.state.bet*n*a;this.state.balance+=c,e.forEach((l,u)=>{l===s&&this.reels[u].highlightWin()}),this.elements.messageDisplay.classList.add("win"),this.showMessage(`ðŸŽ‰ WIN! ${i}x ${s} = ${c} coins! ðŸŽ‰`),setTimeout(()=>{this.elements.messageDisplay.classList.remove("win"),this.reels.forEach(l=>l.clearHighlight())},3e3)}else this.showMessage("Try again!");this.updateDisplay()}updateDisplay(){this.elements.balanceDisplay.textContent=this.state.balance.toString(),this.elements.betDisplay.textContent=this.state.bet.toString()}showMessage(e){this.elements.messageDisplay.textContent=e}}new w;console.log("ðŸŽ° Retro Slot Machine Game Started!");
